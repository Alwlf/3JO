<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<style>
    @import url(//fonts.googleapis.com/earlyaccess/hanna.css);

    .nav-item, .navbar-brand{
      font-family: 'Hanna', sans-serif;
    }

    .popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        visibility: hidden;
        opacity: 0;
        transition: visibility 0s, opacity 0.3s ease;
      }
      .popup-content {
        width: 400px;
        padding: 20px;
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      }
      .popup-content h2 {
        text-align: center;
        margin-top: 0;
      }
      .popup-content form {
        display: flex;
        flex-direction: column;
      }
      .popup-content input[type="text"],
      .popup-content input[type="password"],
      .popup-content input[type="email"],
      .popup-content select {
        margin-bottom: 10px;
        padding: 8px;
        border-radius: 3px;
        border: 1px solid #ccc;
      }
      .popup-content input[type="submit"] {
        padding: 8px 12px;
        border: none;
        border-radius: 3px;
        background-color: #3f51b5;
        color: #fff;
        cursor: pointer;
      }
      .popup-content input[type="submit"]:hover {
        background-color: #303f9f;
      }
      .popup-content .close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        cursor: pointer;
      }

      .popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        visibility: hidden;
        opacity: 0;
        transition: visibility 0s, opacity 0.3s ease;
      }
      .popup-content {
        width: 400px;
        padding: 20px;
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      }
      .popup-content h2 {
        text-align: center;
        margin-top: 0;
      }
      .popup-content form {
        display: flex;
        flex-direction: column;
      }
      .popup-content input[type="text"],
      .popup-content input[type="password"],
      .popup-content input[type="email"],
      .popup-content select {
        margin-bottom: 10px;
        padding: 8px;
        border-radius: 3px;
        border: 1px solid #ccc;
      }
      .popup-content input[type="submit"] {
        padding: 8px 12px;
        border: none;
        border-radius: 3px;
        background-color: #3f51b5;
        color: #fff;
        cursor: pointer;
      }
      .popup-content input[type="button"] {
        padding: 8px 12px;
        border: none;
        border-radius: 3px;
        background-color: #3f51b5;
        color: #fff;
        cursor: pointer;
      }
      .popup-content input[type="submit"]:hover {
        background-color: #303f9f;
      }
      .popup-content .close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        cursor: pointer;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

</style>

<script>

  function openLogin() {
    var popup = document.getElementById("login");
    popup.style.visibility = "visible";
    popup.action = "/project/login_chk/";
    popup.style.opacity = "1";
    popup.submit();
  }

  function Logout(){
    location.href='/project/log_out/';
  }

  function openSignup() {
    var popup = document.getElementById("signup");
    popup.style.visibility = "visible";
    popup.style.opacity = "1";
  }
  
  function openFindId(){
    var popup = document.getElementById("findId");
    popup.style.visibility = "visible";
    popup.style.opacity = "1";
  }

  function openFindPw(){
    var popup = document.getElementById("findPw");
    popup.style.visibility = "visible";
    popup.style.opacity = "1";
  }

  function closeLogin(){
    const bgbg = document.getElementById('login');
    bgbg.style.visibility = "hidden";
  }

  function closeSignup(){
    const bgbg = document.getElementById('signup');
    bgbg.style.visibility = "hidden";
  }

  //중복 체크 후 다른 아이디 변경 했을 경우
  function inputIdChk(){
    document.signup.idDuplication.value="idUncheck";
  }

  var new_window_width = 300;
  var new_window_height = 100;
  var positionX = ( window.screen.width / 2 ) - ( new_window_width / 2 ) -15;
  var positionY = ( window.screen.height / 2 ) - ( new_window_height / 2 );

  function new_window() {
    window.open(
      "/project/idChk",
      "아이디 중복 체크",
      "width=" + new_window_width + ", height=" + new_window_height + ", top=" + positionY + ", left=" + positionX
    );
  }

  function id_handleOnInput(e)  {
    e.value = e.value.replace(/[^0-9A-Za-z]/ig, '').substr(0,10)
  }

  function pw_handleOnInput(e)  {
    e.value = e.value.replace(/[^0-9A-Za-z]/ig, '').substr(0,15)
  }

  function check_pw(){
    if(document.getElementById('pw1').value !='' && document.getElementById('pw2').value!=''){
        if(document.getElementById('pw1').value==document.getElementById('pw2').value){
            document.getElementById('check').innerHTML='비밀번호가 일치합니다.'
            document.getElementById('check').style.color='blue';
        }
        else{
            document.getElementById('check').innerHTML='비밀번호가 일치하지 않습니다.';
            document.getElementById('check').style.color='red';
        }
    }
}

function closeId(){
    const bgbg = document.getElementById('findId');
    bgbg.style.visibility = "hidden";
}

function closePw(){
    const bgbg = document.getElementById('findPw');
    bgbg.style.visibility = "hidden";
}

</script>



<!-- 상단 영역 -->
<header class="bg-primary bg-white">
  <div class="container px-4 text-center">
      <img src="/static/projectapp/images/배너1-1.png"
      style="cursor: pointer;"  onclick="javascript:location.href='/';">
  </div>
</header> 



{% if not request.session.session_user_id  %}
<nav class="navbar navbar-expand-md navbar-light fixed-top bg-transfer">
    <div class="container-fluid">
    <a class="navbar-brand" href="/project">AI PD</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/project">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="#!" onclick="openLogin()">로그인</a></li>
        <div id="login" class="popup-overlay">
            <div class="popup-content">
            <h2>로그인</h2>
            <form name="login" id="login" method="post" action="/project/login_chk/">
                {% csrf_token %}
                <input name="user_id" id="user_id" type="text" placeholder="아이디">
                <input name="user_pw" id="user_pw" type="text" placeholder="비밀번호">
                <div style="display:inline-blodck; text-align:center;">
                  <a href="#findId" onclick="openFindId()">아이디 찾기</a> | <a href="#findPw" onclick="openFindPw()">비밀번호 찾기</a>
                  <br/>          
                  <form>
                    <div style="display:inline-blodck">
                      <input type="submit" style="width:90px; float:left;" value="로그인" onclick="openLogin()">
                      <input type="button" style="width:90px; float:right;" value="취소" onclick="closeLogin()">
                      </div>
                  </form>
                <div id="findId" class="popup-overlay">
                    <div class="popup-content">
                    <h2>아이디 찾기</h2>                      
                      <form name="findId" method="post" action="/project/search_id/">
                        {% csrf_token %}
                        <input name="user_name" type="text" placeholder="이름">
                        <input name="user_email" type="text" placeholder="이메일">
                        <div style="display:inline-blodck">
                        <input type="submit" style="width:90px; float:left;" value="찾기">
                        <input type="button" style="width:90px; float:right;" value="취소" onclick="closeId()">
                        </div>
                      </form>
                    </div>
                </div>  
                <div id="findPw" class="popup-overlay">
                    <div class="popup-content">
                    <h2>비밀번호 찾기</h2>
                    <form id="findPw" name="findPw" method="post" action="/project/search_pw/">
                        {% csrf_token %}
                        <input name="user_id" type="text" placeholder="아이디">
                        <input name="user_email" type="text" placeholder="이메일">
                        <div style="display:inline-blodck">
                        <input type="submit" style="width:90px; float:left;" value="찾기">
                        <input type="button" style="width:90px; float:right;" value="취소" onclick="closePw()">
                        </div>
                    </form>
                    </div>
                </div>  
                </div>
              </form>
            </div>
        </div>

        <li class="nav-item"><a class="nav-link" href="#signup" onclick="openSignup()">회원가입</a></li>
        <div id="signup" class="popup-overlay">
            <div class="popup-content">
            <h2>회원가입</h2>
            <form id="signup" name="signup" method="post" action="/project/insert/">
                {% csrf_token %}
                <input name="name" id="name" type="text" placeholder="이름" required >
                <select name="gender">
                <option value="male">남성</option>
                <option value="female">여성</option>
                </select>
                <input name="email" type="email" placeholder="이메일 (aaa@bbb.ccc 형식)" required>
                <div style="display:inline-blodck">
                <input name="id" id ="id" type="text" placeholder="아이디 (영문,숫자 조합 10자 이하)" style="width:265px;" onkeydown="inputIdChk()" oninput="id_handleOnInput(this)" required>
                <input type="button" id="dbCheckId" style="height:40px; float:right;" value="중복 확인"  onclick="new_window();">
                
                <input type="hidden" id="idDuplication" value = "idUnCheck">
                </div>
                <input name="pw1" id="pw1" type="password" placeholder="비밀번호 (영문,숫자 조합 15자 이하)" oninput="pw_handleOnInput(this)" required >
                <input id="pw2" type="password" onchange="check_pw()" placeholder="비밀번호 확인" required ><span id="check"></span>

                <div style="display:inline-blodck">
                <input type="submit" style="width:90px; float:left;" value="가입" >
                <input type="button" style="width:90px; float:right;" onClick="closeSignup()" value="취소">
                </div>
                
            </form>
            </div>
        </div>
        </ul>
    </div>
    </div>
</nav>

{% else %}
<nav class="navbar navbar-expand-md navbar-light fixed-top bg-transfer">
  <div class="container-fluid">
  <a class="navbar-brand" href="/project">AI PD</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
      <li class="nav-item"><a class="nav-link active" aria-current="page" href="/project">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="#!" onclick="openLogin()">{{ request.session.session_user_name }}님</a></li>
      <input id="user_id" type="hidden" value ={{ request.session.session_user_id }}>
      <input id="user_pw" type="hidden" value ={{ request.session.session_user_pw }}>
      <input id="user_name" type="hidden" value ={{ request.session.session_user_name }}>
      <input id="user_gender" type="hidden" value ={{ request.session.session_user_gender }}>
      <input id="user_email" type="hidden" value ={{ request.session.session_user_email }}>
      <li class="nav-item"><a class="nav-link" aria-current="page" href="/project/mypage">마이페이지</a></li>
      <li class="nav-item"><a class="nav-link" href="#signup" onclick="Logout()">로그아웃</a></li>
      </ul>
  </div>
  </div>
</nav>
{% endif %}
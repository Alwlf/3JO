<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Blog Home - Start Bootstrap Template</title>

        <script type="text/javascript">
          function goUpdate(board_id,user_id,session_id){
            if (user_id == session_id){
              // alert(board_id+'/'+user_id+'/'+session_id);
              url = '/project/board_update_form/?board_id='+board_id;
              url = url+"&user_id="+user_id;
              location.href = url;
            }
          }

        </script>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="/static/projectapp/assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="/static/projectapp/css/styles.css" rel="stylesheet" />
        <style>
          .comment {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
          }
          .comment strong {
            font-weight: bold;
          }
          .reply-form {
            margin-top: 10px;
          }
          .reply-form textarea {
            width: 100%; 
            height: 100px; 
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 3px;
          }
          .reply-form button[type="submit"],
          .comment .delete-button {
            padding: 2px 5px;
            border-radius: 3px;
            cursor: pointer;
          }
          .reply-form button[type="submit"]:hover,
          .comment .delete-button:hover {
            padding: 2px 5px;
            border-radius: 3px;
          }
        </style>
    </head>
    <body>
        <!-- Responsive navbar-->
        {% include "projectapp/include/navbar.html" %}
        <!-- Page header with logo and tagline-->
        <header class="py-5 bg-light border-bottom mb-4">
          <div class="container">
            <div class="text-center my-5">
                <h1 class="fw-bolder">게시판</h1>
                <p class="lead mb-0">고민거리와 자랑거리를 자유롭게 이야기 해봐요!!</p>
            </div>
          </div>
            <br/>
            <button onclick="goUpdate( '{{ board_view.board_id }}', '{{ board_view.user_id }}', '{{ request.session.session_user_id }}'  )">수정</button>
            <button onclick="">삭제</button>
            <table class="table table-hover">
              <tbody>
                 
                  <tr>
                    <td><p>글 제목 : {{ board_view.board_title }}</p></td>
                  </tr>
                  
                  <tr>
                    <td><textarea type="text" class="form-control" placeholder="글 내용을 작성하세요" name="contentDetail" maxlength="1024" style="height: 400px;">{{ board_view.board_content }}</textarea></td>
                  </tr>
                  <tr>
                      <td>
                          <p>
                          첨부파일 : 
                          <input type="file" name="file_nm" id="file_nm">
                          </p>
                      </td>
                  </tr>
                
              </tbody>  
            </table>
          </div>          
          <h5>댓글</h5>
          <hr/>
          <div id="comments">
          </div>
          <form id="comment-form">
            <label for="username">아이디:</label>
            <input type="text" id="username" size="10" required>
            <br/>
            <br/>
            <label for="comment">댓글 :</label>
            <textarea id="comment"rows="4" cols="160" required></textarea>
            <button type="submit">댓글 작성</button>
          </form> 
          <script>
            document.getElementById("comment-form").addEventListener("submit", function(event) {
              event.preventDefault();
              var comment = document.getElementById("comment").value;
              var username = document.getElementById("username").value;
              var newComment = document.createElement("div");
              newComment.classList.add("comment");
              newComment.innerHTML = "<strong>" + username + "</strong>: " + comment;
              var replyButton = document.createElement("button");
              replyButton.innerHTML = "답글 달기";
              replyButton.addEventListener("click", function() {
                var replyForm = document.createElement("div");
                replyForm.classList.add("reply-form");
                replyForm.innerHTML = `
                  <label for="reply-username">아이디:</label>
                  <input type="text" id="reply-username">
                  <label for="reply-comment">대댓글:</label>
                  <textarea id="reply-comment"></textarea>
                  <button class="reply-button">답글 작성</button>
                  <button class="delete-button">답글 삭제</button>
                `;
                var commentContainer = this.parentNode;
                commentContainer.appendChild(replyForm);
                var replyButton = replyForm.querySelector(".reply-button");
                var deleteButton = replyForm.querySelector(".delete-button");
        
                replyButton.addEventListener("click", function() {
                  var replyComment = replyForm.querySelector("textarea").value;
                  var replyUsername = replyForm.querySelector("#reply-username").value;
                  var newReply = document.createElement("div");
                  newReply.classList.add("comment");
                  newReply.innerHTML = "<strong>" + replyUsername + "</strong>: " + replyComment;
                  var deleteButton = document.createElement("button");
                  deleteButton.classList.add("delete-button");
                  deleteButton.innerHTML = "답글 삭제";
                  deleteButton.addEventListener("click", function() {
                    commentContainer.removeChild(newReply);
                    commentContainer.removeChild(deleteButton);
                  });
                  replyForm.parentNode.insertBefore(newReply, replyForm.nextSibling);
                  replyForm.parentNode.insertBefore(deleteButton, replyForm.nextSibling);
        
                  commentContainer.removeChild(replyForm);
                });
        
                deleteButton.addEventListener("click", function() {
                  commentContainer.removeChild(this.parentNode);
                });
              });
              newComment.appendChild(replyButton);
              var commentsContainer = document.getElementById("comments");
              commentsContainer.insertBefore(newComment, commentsContainer.firstChild);
              document.getElementById("comment").value = "";
              document.getElementById("username").value = "";
            });
          </script>
    </header>
 
        <!-- Footer-->
        {% include "projectapp/include/footer.html" %}
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="/static/projectapp/js/scripts.js"></script>
        <script type="text/javascript"
        src="/static/projectapp/js/bootstrap.bundle.min.js"></script>
</body>
</html>